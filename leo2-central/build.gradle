// Gradle dependencies/plugins
buildscript {
    repositories {
        jcenter()
        mavenCentral()
    }

    dependencies {
        // cargo gradle plugin for remote delpoyment
        classpath 'org.gradle.api.plugins:gradle-cargo-plugin:1.+'

//        // jooq codegen gradle plugin
//        classpath 'com.github.ben-manes:gradle-jooq-plugin:0.6'
//        // override jooq dependencies of gradle-jooq-plugin with desired version
//        classpath('org.jooq:jooq-codegen:3.4.1') {
//            force: true
//        }
//        classpath('org.jooq:jooq-meta:3.4.1') {
//            force: true
//        }
//
//        // mysql jdbc connector
//        classpath 'mysql:mysql-connector-java:5.1.31'
    }
}

apply plugin: 'java'
// IDEs
apply plugin: 'idea'
apply plugin: 'eclipse'
// Webservice
apply plugin: 'war'
apply plugin: 'cargo'

apply plugin: 'application'
//apply plugin: 'jooq'

sourceCompatibility = 1.8
version = '0.1'
mainClassName = "org.deku.leo2.rest.Main"

repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.+'

    // webservice dependencies

    // For various javax interfaces (eg. ServletContextListener)
    compile 'javax.servlet:javax.servlet-api:3.+'

    compile 'org.glassfish.jersey.containers:jersey-container-servlet:2.+'
    compile 'org.glassfish.jersey.media:jersey-media-json-jackson:2.+'
    // jersey webservice container for local running/debugging
    compile 'org.glassfish.jersey.containers:jersey-container-grizzly2-http:2.+'

    // leo2 webservice dependencies
    compile project(':leo2-common')

    // persistence framework(s)
    // eclipselink
    compile 'org.eclipse.persistence:eclipselink:2.+'

//    // jooq
//    compile 'org.jooq:jooq:3.4.1'
//    compile 'org.jooq:jooq-meta:3.4.1'
//    compile 'org.jooq:jooq-codegen:3.4.1'

    // jdbc connector(s)
    compile 'mysql:mysql-connector-java:5.+'

    compile 'org.jinq:jinq-jpa:+'
}

run {
    errorOutput = System.err
    standardOutput = System.out
    standardInput = System.in
}

// war plugin configuration
war {
}

// cargo plugin configuration
cargo {
    containerId = 'tomcat7x'
    port = 8080

    deployable {
        context = '/leo2'
    }

    remote {
        hostname = '10.0.10.10'
        username = 'tomcat'
        password = 'tomcat'
    }
}


//jooq {
//    jdbc {
//        url 'jdbc:mysql://10.0.10.10:3306'
//        driver 'com.mysql.jdbc.Driver'
//        user 'root'
//        password 'root'
//    }
//    generator {
//        database {
//            name 'org.jooq.util.mysql.MySQLDatabase'
//            inputSchema 'dekuclient'
//
//            includes 'tbldepotliste'
//            //excludes '.*'
//
//            // masc20140916. (almost) all tables
//            //includes '.*'
//            //excludes 'tbl_auftrag_info'
//        }
//
//        target {
//            packageName 'org.deku.leo2.persistence.jooq.dekuclient'
//            directory new File(project.projectDir, 'src/main/java').toString()
//        }
//    }
//}

// task dependencies
tasks.cargoDeployRemote.dependsOn(war)
tasks.cargoRedeployRemote.dependsOn(war)

//tasks.generateJooq.outputs.upToDateWhen { false }


