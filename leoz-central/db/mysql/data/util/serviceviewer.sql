USE dekuclient;
CREATE OR REPLACE
  ALGORITHM = UNDEFINED
VIEW dev_v_serviceviewer AS
  SELECT
    `tad_v_order`.`id`,
    `tad_v_order_parcel`.`scan_id`,
    `tad_v_order`.`service`,
    (`tad_v_order`.`service` & 32) = 32               AS RECEIPT_ACKNOWLEDGEMENT,
    (`tad_v_order`.`service` & 128) = 128             AS CASH_SERVICE,
    `tad_v_order`.`cash_amount`,
    (`tad_v_order`.`service` & 262144) = 262144       AS XCHANGE,
    `tad_v_order`.`sdgtype` IN ('X', 'Z')             AS XCHANGE_PRIMARY,
    `tad_v_order`.`sdgtype` IN ('R', 'Q')             AS XCHANGE_RETOURE,
    `tad_v_order`.`reference_id_to_exchange_id`,
    (`tad_v_order`.`service` & 256) = 256             AS VALUED_PACKAGE,
    (`tad_v_order`.`service` & 16384) = 16384         AS IDENT_CONTRACT_SERVICE,
    (`tad_v_order`.`service` & 32768) = 32768         AS SUBMISSION_PARTICIPATION,
    (`tad_v_order`.`service` & 65536) = 65536         AS SECURITY_RETURN,
    (`tad_v_order`.`service` & 1048576) = 1048576     AS DOCUMENTED_PERSONAL_DELIVERY,
    (`tad_v_order`.`service` & 4194304) = 4194304     AS DEPARTMENT_DELIVERY,
    (`tad_v_order`.`service` & 16777216) = 16777216   AS FAIR_SERVICE,
    (`tad_v_order`.`service` & 67108864) = 67108864   AS PACKAGING_RECIRCULATION,
    (`tad_v_order`.`service` & 268435456) = 268435456 AS POSTBOX_DELIVERY,
    (`tad_v_order`.`service` & 536870912) = 536870912 AS NO_ALTERNATIVE_DELIVERY,
    `tad_v_order`.`sdgtype`,
    `tad_v_order`.`customer_station`,
    `tad_v_order`.`pickup_station`,
    `tad_v_order`.`delivery_station`,
    `tad_v_order`.`number_of_parcels`,
    `tad_v_order`.`weight_of_order`,
    `tad_v_order`.`pickup_information1`,
    `tad_v_order`.`pickup_information2`,
    `tad_v_order`.`delivery_information`,
    `tad_v_order`.`content`,
    `tad_v_order`.`pickup_address_line1`,
    `tad_v_order`.`pickup_address_line2`,
    `tad_v_order`.`pickup_address_line3`,
    `tad_v_order`.`pickup_address_street`,
    `tad_v_order`.`pickup_address_street_no`,
    `tad_v_order`.`pickup_address_country_code`,
    `tad_v_order`.`pickup_address_zip_code`,
    `tad_v_order`.`pickup_address_city`,
    `tad_v_order`.`pickup_address_phoneNumber`,
    `tad_v_order`.`delivery_address_line1`,
    `tad_v_order`.`delivery_address_line2`,
    `tad_v_order`.`delivery_address_line3`,
    `tad_v_order`.`delivery_address_street`,
    `tad_v_order`.`delivery_address_street_no`,
    `tad_v_order`.`delivery_address_country_code`,
    `tad_v_order`.`delivery_address_zip_code`,
    `tad_v_order`.`delivery_address_city`,
    `tad_v_order`.`delivery_address_phoneNumber`,
    `tad_v_order`.`appointment_pickup_start`,
    `tad_v_order`.`appointment_pickup_end`,
    `tad_v_order`.`appointment_pickup_not_before_start`,
    `tad_v_order`.`appointment_delivery_start`,
    `tad_v_order`.`appointment_delivery_end`,
    `tad_v_order`.`appointment_delivery_not_before_start`,
    `tad_v_order_parcel`.`order_id`,
    `tad_v_order_parcel`.`last_delivery_list_id`,
    `tad_v_order_parcel`.`parcel_type`,
    `tad_v_order_parcel`.`dimension_length`,
    `tad_v_order_parcel`.`dimension_height`,
    `tad_v_order_parcel`.`dimension_width`,
    `tad_v_order_parcel`.`dimention_weight`
  FROM
    tad_v_order
    LEFT JOIN
    tad_v_order_parcel ON tad_v_order.id = tad_v_order_parcel.order_id
